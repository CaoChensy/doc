# 时间序列分析

## 时间序列分析简介

- 描述性时间序列分析

- 统计时间序列分析
    - 频率分析方法 | 频谱分析 | 谱分析方法
    - 时域分析方法
        - 序列自相关: 事务发展的惯性

1. 考察观察值序列的特征
2. 选择适当的拟合模型
3. 根据序列的观察数据确定模型的口径
4. 检验模型
5. 优化模型
6. 使用拟合好的模型来推断序列其他的统计性质或预测序列未来的发展

---

## 时间序列的预处理

- 时间序列的预处理
    - 平稳性检验
    - 纯随机性检验
    
> 平稳性检验

- 特征统计量
- 平稳时间序列的定义
- 平稳时间序列的统计性质
- 平稳时间序列的意义
- 平稳性的检验

> 时间序列的概率分布

对于时间序列 $\\{X_t,\ t\in T\\}$, 任取正整数 $m$，任取$t_1,\ t_2,\ ...,\ t_m\in T$，
则$m$维随机向量$(X_{t_1},\ X_{t_2},\ ...,\ X_{t_m})$的联合概率分布定义为:
$$
F_{t_1, t_2, ..., t_m}(x_1, x_2, ..., x_m) = P(X_{t_1}<x_1, X_{t_2}<x_2, ...,X_{t_m}<x_m)
$$
由这些有限维分布函数构成的全体:
$$
\\{F_{t_1, t_2, ..., t_m}(x_1, x_2, ..., x_m),\ \forall m\in 正整数,\ \forall t_1,\ t_2,\ ...,\ t_m\in T\\}
$$
就成为时间序列$\\{X_t,\ t \in T\\}$的概率分布族。

> 时间序列分布的低阶矩

**特征统计量: 均值、方差、自协方差、自相关系数**

- 时间序列的均值

对于时间序列$\\{X_t,\ t \in T\\}$，任意时刻的序列值 $X_t$ 都是一个随机变量，分布函数为 $F_t(x)$，
若满足:
$$
\int_{-\infty}^{\infty} xdF_t(x) < \infty
$$
则一定存在某个常数 $\mu_t$ 使随机变量 $X_t$ 总是在常数 $\mu_t$ 附近做随机波动，称 $\mu_t$ 为序列 
$\\{X_t\\}$ 在 $t$ 时刻的均值函数，记为:
$$
\mu_t = E(X_t) = \int_{-\infty}^{\infty} xdF_t(x)
$$
当$t$取遍全部观察时刻时，就得到均值函数序列$\\{X_t,\ t\in T\\}$，反应的是时间序列$\\{X_t,\ t\in T\\}$
每时每刻的平均水平

- 时间序列的方差

当 $\int_{-\infty}^{\infty} xdF_t(x) < \infty$ 时，定义时间序列的方差函数:
$$
\sigma_t^2 = D(X_t) = E(X_t - \mu_t)^2 = \int_{-\infty}^{\infty} (x-\mu_t)^2 dF_t(x)
$$
当$t$取遍全部观察时刻时，就得到方差函数序列$\\{\sigma_t^2,\ t\in T\\}$，

- 自相关系数和自协方差

对于时间序列$\\{X_t,\ t \in T\\}$，任取 $t,s \in T$，**自协方差函数**定义为:

$$
r(t, s) = E(X_t-\mu_t)(X_s-\mu_s)
$$

**自相关系数**定义为:

$$
\rho(t, s) = \frac{r(t, s)}{\sqrt{D(X_t) \cdot D(X_s)}}
$$

> 平稳时间序列的定义

- 严平稳时间序列: 所有统计性质不随$t$变化。

对时间序列$\\{X_t,\ t \in T\\}$，对于任意正整数$m$，任取$t_1, t_2, L, t_m \in T$，
任意正整数$\tau$，有

$$
F_{t_1, t_2, L, t_m}(x_1, x_2, L, x_m) = F_{t_(1+\tau), t_(2+\tau), L, t_(m+\tau)}(x_1, x_2, L, x_m)
$$

则称时间序列$\\{X_t,\ t \in T\\}$为严平稳时间序列。

- 宽平稳时间序列: 特征统计量稳定，低阶矩平稳。

对时间序列$\\{X_t,\ t \in T\\}$，如果满足以下三个条件:
1. 任取$t\in T$，有$E(X_t^2)<\infty$;
1. 任取$t\in T$，有$E(X_t)=\mu, \mu$为常数;
1. 任取$t, s, k \in T$，且$k + s - t \in T$，有$r(t, s) = r(k, k+s-t)$.

则称$\\{X_t,\ t \in T\\}$为宽平稳时间序列（弱平稳、二阶平稳）。

⚠️: $(3) \Leftrightarrow r(t, s) = r(t+\tau, s+\tau)$，其中，$t, s \in T, t+\tau \in T, s+\tau \in T$.

- 严平稳与宽平稳
    - 柯西分布严平稳$\nRightarrow$宽平稳: 一阶矩、二阶矩不存在。
    - 二阶矩存在的严平稳为宽平稳
    - 序列为多元正态分布时，宽平稳为严平稳。
    
- 正态时间序列

对时间序列$\\{X_t,\ t \in T\\}$，若任取正整数$n$，任取$t_1, t_2, ..., t_n \in T$，
相对应的有限随机变量$X_1, X_2, ..., X_n$服从$n$维正态分布，密度函数为:
$$
f_{t_1, t_2, L, t_n}(x_n) = (2\pi)^{-\frac{n}{2}}|\Gamma_n|^{-\frac{1}{2}}exp[-\frac{1}{2}(x_n - \mu_n)'\Gamma_n^{-1}(x_n-\mu_n)]
$$

其中，$x_n = (X_1, X_2, L, X_n)'$，$\mu_n = (EX_1, EX_2, L, EX_n)'$，$\Gamma_n$ 为协方差矩阵。

$$
\Gamma_n = 
\begin{bmatrix}
\gamma (t_1, t_1) & \gamma(t_1, t_2) & L & \gamma(t_1, t_n) \\\\
\gamma (t_2, t_1) & \gamma(t_2, t_2) & L & \gamma(t_2, t_n) \\\\
M & M & \ & M \\\\
\gamma (t_n, t_1) & \gamma(t_n, t_2) & L & \gamma(t_n, t_n) \\\\
\end{bmatrix}
$$

> 平稳时间序列统计性质与意义

- **性质1**: 常数均值
$$
EX_t = \mu, \forall t\in T \\\\
$$
- **性质2**: 自协方差函数和自相关函数只依赖于时间的平移长度而与时间的起止点无关
$$
\gamma(t, s) = \gamma(k, k + s - t), \forall t, s, k \in T
$$
二维函数 $\gamma(t, s)$ 简化为一维函数 $\gamma(s - t)$
$$
\gamma(s-t) \equiv \gamma(t, s), \forall t, s \in T,
$$

**延迟`K`自协方差函数**

对于平稳时间序列 $\\{X_t, t \in T\\}$，任取 $t(t + k \in T)$，该时间序
列的延迟$k$自协方差函数和延迟 $k$ 自相关系数定义如下：

**延迟$k$自协方差函数**
$$
\gamma(k) = \gamma(t, t+k), \forall k 为整数.
$$
平稳随机序列一定具有常数方差，即$DX_t = r(t, t) = r(0), \forall t \in T$

**延迟$k$自相关系数**
$$
\rho_k = \frac{\gamma(t, t+k)}{\sqrt{DX_t \cdot DX_{t+k}}} = \frac{\gamma(k)}{\gamma(0)}
$$

**自相关系数的性质**

- 规范性: $\rho_0 = 1 \ and\ |\rho_k| \le 1, \forall k$
- 对称性: $\rho_k = \rho_{-k}$
- 非负定性: 对任意的正整数$m$,相关阵 $\Gamma_m$ 为对称非负定阵
$$
\Gamma_m = 
\begin{bmatrix}
\rho_0 & \rho_1 & L & \rho_{m-1} \\\\
\rho_1 & \rho_0 & L & \rho_{m-2} \\\\
M & M & \ & M \\\\
\rho_{m-1} & \rho_{m-2} & L & \rho_{0} \\\\
\end{bmatrix}
$$
- 非唯一性: 一个平稳时间序列一定唯一决定了它的自相关系数，
但一个自相关系数未必唯一对应着一个平稳时间序列。

**意义:**

- 时间序列数据结构：可列多个随机变量，而每个变量只有一个样本观察值。
- 在平稳序列场合，`序列的均值等于常数`，这意味着原本含有可列多个随机变量的均值序
列变成了只含有一个变量的常数序列。
$$\\{\mu_t, t \in T\\} \Rightarrow \\{\mu, t \in T\\}$$
- 原本每个随机变量的均值（/方差/自相关系数）只能依靠唯一的一个样本观察值去估计，
现在由于平稳性，每一个统计量都将拥有大量的样本观察值。
`这极大地减少了随机变量的个数，并增加了待估变量的样本容量。`极大地简化
了时序分析的难度，同时也提高了对特征统计量的估计精度。

**样本自协方差函数**

**延迟k自协方差函数的估计值**
$$
\begin{aligned}
\hat{\gamma}(k) & = \frac{1}{n-k}\sum_{t=1}^{n-k}(x_t - \overline{x})(x_{t+k} - \overline{x}), 0<k<n,\\\\
& = \frac{1}{n-k}\sum_{t=k+1}^{n}(x_t - \overline{x})(x_{t-k} - \overline{x}), 0<k<n,
\end{aligned}
$$
**总体方差的估计值**
$$
\hat{\gamma}(0) = \frac{1}{n-1}\sum_{t=1}^{n}(x_t - \overline{x})^2
$$
**延迟k自相关系数的估计值**
$$
\begin{aligned}
\hat{\rho}_k & = \frac{\hat{\gamma}(k)}{\hat{\gamma}(0)}, \forall 0<k<n \\\\
\end{aligned}
$$

当延迟阶数k远远小于样本容量n时，

$$
\begin{aligned}
\hat{\rho}\_k & = \frac{\hat{\gamma}(k)}{\hat{\gamma}(0)} \\\\
& = \frac{\frac{1}{n-k}\sum_{t=1}^{n-k}(x_t - \overline{x})(x\_{t+k} - \overline{x})}
         {\frac{1}{n}  \sum_{t=1}^n (x_t - \overline{x})^2} \\\\
& \approx \frac{\sum_{t=1}^{n-k}(x_t - \overline{x})(x\_{t+k} - \overline{x})}{\sum_{t=1}^n (x_t - \overline{x})^2}
\end{aligned}
$$

> 平稳性的检验

1. 图检验方法(时序图检验、自相关图检验)
    - 特点：操作简单，应用广泛，但结论带有一定主观性。
    - 自相关图是以自相关系数为横轴，延迟时期数为倒纵轴，
    水平方向的垂线表示自相关系数的大小，是一个二维平面坐标悬垂线图。
    根据平稳序列通常具有短期相关性的特点，则随着延
    迟期数$k$的增加，平稳序列的自相关系数会很快地衰减为零，
    而非平稳序列的自相关系数较慢地衰减为零。
2. 统计检验方法（单位根检验）
    - 特点：根据特征根是否在单位圆内来判断平稳性，有多种类型，结果具有客观性。
    
> 纯随机序列的定义和性质

**序列值间没有任何相关性，过去的行为对将来的发展没有丝毫影响，
这种序列称为纯随机序列，也称白噪声序列。**从统计分析的角度而言，
纯随机序列是没有任何实际分析价值的序列。

**定义**

如果时间序列$\\{X_t, t \in T\\}$满足如下性质:

$$
EX_t = \mu, \forall t \in T \tag{1}
$$

$$
\gamma(t, s)
\begin{cases}
\sigma^2, t = s\\\\
0, t \ne s
\end{cases}
, \forall t, s \in T \tag{2}
$$

则称序列 $\\{X_t, t \in T\\}$ 为纯随机序列，也称为白噪声序列，简记为 $X_t\sim WN(\mu, \sigma^2)$。

⚠️ 注意:

1. 白噪声序列一定是平稳序列，而且是最简单的平稳序列。
2. 纯随机序列是一种没有分析价值的序列（统计不相关）。

- 纯随机性检验
    - 经过平稳性检验，可以判断出序列是否为平稳序列。
    若是非平稳，将在后面讨论。对于平稳序列，理论上都有成熟的建模方法。
    - 只有那些序列值之间有密切相关关系，历史数据
    对未来的发展有一定影响的序列，才值得去挖掘历史
    数据中的有效信息，用来预测序列未来的发展。
    这也是为什么要进行纯随机性检验的原因。
    - 序列值间有密切相关关系，历史数据对未来的发展有一定影响的序列

**性质**

- **纯随机性**

指白噪声序列各值之间没有任何相关关系，即为“无记忆”的序列。
序列完全无序的随机波动，没有任何值得提取的有用相关信息。
**自协方差和自相关系数为0**，即

$$
\begin{aligned}
\gamma(k) = 0, & \forall k\ne 0 \\\\
\rho_k = 0, & \forall k \ne 0 \\\\
\end{aligned}
$$

⚠️ 注意:
1. 对于一个观察值序列，一旦相关信息全部提取（通过拟合模型
进行）完毕，则剩余的残差序列应具有纯随机性。
1. 检验残差的纯随机性是用于判定序列相关信息是否提取充分的
标准之一。

- **方差齐性**

指白噪声序列中每个变量的方差都相等。

$$
DX_t = \gamma(0) = \sigma^2
$$

根据马尔可夫定理，只有方差齐性的序列，用最小二乘
法得到的未知参数估计值才是准确的、有效的。

⚠️ 注意: 
1. 对于一个观察值序列，一旦相关信息全部提取完毕，则剩
余的残差序列应具有方差齐性。
1. 检验残差的方差齐性是用于判定序列相关信息是否提取充
分（即白噪声序列）的另一标准。

> 纯随机性检验

纯随机性检验也称为**白噪声检验**，是专门用来检验序列是否为纯随机序列的一种方法。

根据纯随机性的定义，只要满足自协方差或自相关系数为$0$，即

$$
\gamma(k) = 0, \forall k \ne 0 或 \rho_k = 0, \forall k\ne 0
$$

则该序列就具有纯随机性。实际上，由于观察值序列的有限性，
纯随机序列的样本自相关系数不会绝对为0。

**Barlett定理**

对一个`纯随机`的时间序列，得到一个$n$期（观察期数）的观察序列 $\\{x_t, t=1, ..., n\\}$,
则该序列的延迟 $k(k \ne 0)$ 期的样本自相关系数将近似服从均值为$0$，方差为$1/n$的正态分布，即

$$
\hat{\rho}_k \dot \sim N(0, \frac{1}{n}), \forall k \ne 0\\\\
\sqrt{n} \hat{\rho}_k \dot \sim N(0, 1)
$$

**假设检验的基本步骤**

1. 根据问题设定假设检验的原假设与备择假设
2. 构造合适的检验统计量并确定检验统计量的分布
3. 给定显著性水平，一般显著性水平(0.05)，然后根据显著性水平和检验统计量的分布来确定拒绝域
4. 计算检验统计量的大小，根据它是否属于拒绝域来确定原假设的接受还是拒绝。

**统计假设**

- 延迟期数小于或等于 $m$ 的序列值间相互独立

$$
H_0: \rho_1 = \rho_2 = ... \rho_m = 0, \forall m \geqslant 1
$$

- 延迟期数小于或等于$m$的序列值间有相关性

$$
H_1: 至少存在某个 \rho_k \ne 0, \forall m \geqslant 1, k \leqslant m
$$

**检验统计量**

- Q统计量(Box和Pierce): 适合大样本，由barlett定理及卡方统计量定义

$$
Q = n \sum_{k=1}^m \hat{\rho}_k^2 \sim \chi^2(m)
$$

$n$ 为序列观察期数，$m$ 为序列延迟期数。

- LB统计量(Box和Ljung): 适合小样本，是对Q统计量的修正，因其较准确，现一般都采用LB统计量

$$
LB = n(n+2)\sum_{k=1}^m(\frac{\hat{\rho}_k^2}{n-k}) \sim \chi^2(m)
$$

**判别原则**

- 拒绝原假设: 当检验统计量大于 $\chi^2_{1-\alpha}(m)$ 分位点，或该统计量的 $P$ 值
小于 $\alpha$ 时，则可以以 $1-\alpha$ 的置信水平拒绝原假设，认
为该序列为非白噪声序列。

- 接受原假设: 当检验统计量小于 $\chi^2_{1-\alpha}(m)$ 分位点，或该统计量的 $P$ 值
大于 $\alpha$ 时，则认为在 $1-\alpha$ 的置信水平下无法拒绝原假
设，即不能显著拒绝序列为纯随机序列的假定。

---

## 平稳时间序列分析

> 方法性工具

```mermaid
graph LR
    方法性工具-->平稳时间序列模型的概念和统计性质;
    平稳时间序列模型的概念和统计性质-->参数估计;
    参数估计-->模型检验;
    模型检验-->预测;
    预测-->建模过程;
    建模过程-->建模平稳性的判定;
```

- **差分运算**
    - 一阶差分: $\Delta y_t = y_t - y_{t-1}$
    - $P$ 阶差分: $\Delta^py_t = \Delta(\Delta^{p-1}y_t) = \Delta^{p-1}y_t - \Delta^{p-1}y_{t-1}, p=1, 2, ...$ 有 $\Delta^py_t = \sum^p_{i=0}(-1)^iC_p^iy_{t-i}$
    - $k$ 步差分：$\Delta_ky_t = y_t - y_{t-k}, k=1, 2, ...$
    - 差分性质:
        - $\Delta (C) = 0$, $C$为常数;
        - $\Delta(ax_t+by_t) = a\Delta x_t + b\Delta y_y$, $a, b$ 为常数
        - 🔨
    
- **延迟算子**
    - 延迟算子类似于时间指针，当前序列值乘以一个延迟算子，就相当于把当前序列值得时间向过去拨了
    一个时刻，记B为延迟算子。

$$
\begin{aligned}
x_{t-1} & = Bx_t \\\\
x_{t-2} & = B^2x_t \\\\
& ... \\\\
x_{t-p} & = B^px_t, \forall p \ge 1
\end{aligned}
$$

- **延迟算子与差分运算的关系**
    - $p$阶差分
    $$\Delta^p x_t = (1-B)^px_t = \sum_{i=0}^p(-1)^iC_p^ix_{t-i}$$
    - $k$步差分
    $$\Delta_kx_t = x_t - x_{t-k} = (1-B^k)x_t$$

- **线性差分方程**
    - 线性差分方程 - 标准形式
    $$z_t + \alpha_1 z_{t-1} + \alpha_2 z_{t-2} + ... + \alpha_p z_{t-p} = h(t)$$
    - 齐次线性差分方程 - 标准形式
    $$z_t + \alpha_1 z_{t-1} + \alpha_2 z_{t-2} + ... + \alpha_p z_{t-p} = 0$$
    - 注意: 标准形式里最大时刻序列对应的系数是`1`。
    - 求解: 🔨
    - 作用: 线性差分方程在时间序列分析中有重要的应用。
    常用的时间序列模型和某些模型自协方差函数和自相关函数都可视为线性差分方程，
    我们可以利用差分方程来研究时间序列模型及其自协方差函数和自相关函数的性质。

> 平稳时间序列模型的概念

- 随机时间序列模型: 仅用他的过去值及随机扰动项所建立起来的模型。
$$X_t = F(X_{t-1}, X_{t-2}, ..., \mu_t)$$

*例子: 银行存款利率关系，一阶自回归过程`AR(1)`。*
$X_t = \varphi X_{t-1} + \varepsilon_t$

- ARMA模型
    - 线性模型，参数少。
    - 便于分析数据的结构和内在性质。
    - 便于在最小方差意义下进行最佳预测控制。

> AR 模型 - $p$阶自回归模型，$AR(p)$

$$
\begin{aligned}
\begin{cases}
x_t = \varphi_0 + \varphi_{1}x_{t-1} + \varphi_{2}x_{t-2} + \varphi_{p}x_{t-p} + \varepsilon_t \\\\
\varphi_p \ne 0 \\\\
E(\varepsilon_t) = 0, Var(\varepsilon_t) = \sigma_{\varepsilon}^2, E(\varepsilon_t \varepsilon_s) = 0, s \ne t \\\\
E(x_s \varepsilon_t) = 0, \forall s<t.
\end{cases}
\end{aligned}
$$

1. 最高阶为$p$
2. 保证残差零均值白噪声
3. 保证$t$期的随机干扰与过去$s$期的序列值无关
4. 当$\varphi_0 = 0$时，成为中心化$AR(p)$模型

- $AR(p)$ 序列中心化变换: 将非中心化的$AR(p)$转化为中心化$AR(p)$。

令$\mu = \frac{\varphi_0}{1-\varphi_1-...-\varphi_p}$
则
$$
\begin{aligned}
x_t & = \mu(1-\varphi_1-...-\varphi_p) + \varphi_1x_{t-1} + \varphi_2x_{t-2} + ... + \varphi_px_{t-p} + \varepsilon_t \\\\
& = \mu + \varphi_1(x_{t-1} - \mu) + ... + \varphi_p(x_{t-p} - \mu) + \varepsilon_t \\\\
x_t - \mu & = \varphi_1(x_{t-1} - \mu) + ... + \varphi_p(x_{t-p} - \mu) + \varepsilon_t \\\\
\end{aligned}
$$
变换$y_t = x_t -\mu$成为中心化变换。

**平稳性判定**

- 时序图和自相关图方法
- 平稳域判别法和单位根判别法
- AR 模型平稳性的条件
    - 特征根判别
        1. $AR(p)$模型平稳的充要条件是它的$p$个特征根都在单位圆内，特征根$|\lambda_1 < 1|$
        2. 根据特征根和自回归系数多项式的根成倒数的性质，等价判别条件是该模型的自回归系数多项式
        的单位根都在单位圆外，$\Phi(\mu) = 0$ 的根$|\mu_i|>1$
    - 平稳域判别
        - 平稳域的定义: 使特征根都在单位圆内的$AR(p)$的系数集合，即$\\{\varphi_1, \varphi_2, ..., \varphi_p|特征根都在单位圆内\\}$
        - 比较适合低阶AR模型，如1，2阶，高阶模型不容易推到平稳域
    - 经验判断准则
        - $AR(p)$ 模型平稳性的必要条件是: $\varphi_{1} + \varphi_{2} + ... + \varphi_{p} < 1$
        - $AR(p)$ 模型平稳性的充分条件是: $|\varphi_{1}| + |\varphi_{2}| + ... + |\varphi_{p}| < 1$

**统计性质**

- 均值

$$E(x_t) = E(\varphi_{0} + \varphi_{1}x_{t-1} + ... + \varphi_{p}x_{1-p} + \varepsilon_t)$$
因平稳序列均值为常数，且$\\{ \varepsilon_t \\}$为白噪声序列，有$E(x_t) = \mu, E(\varepsilon_t) = 0, \forall t \in T$
则:

$$
\begin{aligned}
E(x_t) & = E(\varphi_{0} + \varphi_{1}x_{t-1} + ... + \varphi_{p}x_{1-p} + \varepsilon_t) \\\\
& = E(\varphi_{0}) + \varphi_{1}E(x_{t-1}) + ... + \varphi_{p}E(x_{1-p}) + E(\varepsilon_t) \\\\
& = \varphi_{0} + \varphi_{1}\mu + ... + \varphi_{p}\mu \\\\
\mu & = \varphi_{0} + \varphi_{1}\mu + ... + \varphi_{p}\mu \\\\
& = \frac{\varphi_0}{1 - \varphi_1 - ... - \varphi_p}
\end{aligned}
$$

- 方差



> MA 模型: $MA(q)$, $q$阶移动平均模型

$$
\begin{cases}
x_t = \mu + \varepsilon_t + \theta_{1} \varepsilon_{t-1} + \theta_{2} \varepsilon_{t-2} + ... + \theta_{q} \varepsilon_{t-q} \\\\
\theta_q \ne 0 \\\\
E(\varepsilon_t) = 0, Var(\varepsilon_t) = \sigma_{\varepsilon}^2, E(\varepsilon_t \varepsilon_s) = 0, s \ne t.
\end{cases}
$$

当$\mu = 0$时，中心化$MA(q)$模型。简$x_t = \Theta(B)\varepsilon_t$。
$q$阶移动平均系数多项式: $\Theta(B) = 1 - \theta_1 B - \theta_2 B^2 - ... - \theta_q B^q $。

**平稳性判定**

方差存在且有界的$MA$模型生成的序列总是平稳的，所以对应的$MA$模型也总是平稳的。

**统计性质**


> ARMA 模型: $ARMA(p, q)$

$$
\begin{cases}
x_t = \phi_0 + \phi_1 x_{t-1} + ... + \phi_p x_{1-p} + \varepsilon_t - \theta_1 \varepsilon_{t-1} - ... - \theta_q \varepsilon_{t-q}\\\\
\phi_p \ne 0, \theta_q \ne 0 \\\\
E(\varepsilon_t) = 0, Var(\varepsilon_t) = \sigma_{\varepsilon}^2, E(\varepsilon_t \varepsilon_s) = 0, s \ne t \\\\
E(x_s, \varepsilon_{t}) = 0, \forall s < t.
\end{cases}
$$

$\phi_0 = 0$ 时，为中心化$ARMA(p, q)$模型，简记为: $\Phi (B) x_t = \Theta (b) \varepsilon_t$
- $p$阶自回归系数多项式: $\Phi (B) = 1 - \phi_1B - \phi_2B^2 - ... - \phi_pB^p$
- $q$阶自回归系数多项式: $\Theta (B) = 1 - \theta_1 B - \theta_2 B^2 - ... - \theta_q B^q$

**平稳性判定**

$p$阶自回归系数多项式$\Phi(B) = 0$的根都在单位圆外，
即$ARMA(p,q)$模型的平稳性完全由其自回归部分的平稳性决定。

给定原始模型$\Phi(B)X_t = \Theta(B)\varepsilon_t$, 令$z_t = \Theta(B)\varepsilon_t$，
因为$z_t$是关于平稳序列$\varepsilon_t$的线性组合，很容易验证$z_t$是平稳的零均值白噪声序列。
所以$\Theta(B) x_t= z_t$可以看做是一个$AR$模型。

**统计性质**



> 平稳时间序列的建模过程 - p(17)

```mermaid
graph LR
    建模步骤-->模型识别;
    模型识别-->参数估计;
    参数估计-->模型检验;
    模型检验-->模型优化;
    模型优化-->序列预测;
```

**平稳时间序列建模步骤**

1. 平稳非白噪声序列: 观察值序列通过平稳性检验与纯随机性检验
    - 自相关图`SACF`
    - 偏自相关图`SPACF`
    - 将原序列转变为平稳的`0`均值序列，建立`中心化的ARMA`模型。
    - 方差非平稳: 对数变换，平方根变换等: 经济时间序列先对数据取对数，消除异方差，再进行分析相关图。
    - 均值非平稳: 差分变换，可以通过相关图进行粗略判断。
        - 差分运算至获得平稳序列，一般差分`0-2`。
        - 非零均值的平稳序列两种处理方法:
            - 设$x_t$为一非零均值的平稳序列，且有$E(x_t) = \mu$
            - 方法1: 用样本均值$\overline{x}$作为序列均值$\mu$的估计，建模前先对序列做如下处理，
            $w_t = x_t - \overline{x}$然后对零均值平稳序列$w_t$建模。
            - 方法2: 在模型识别阶段对序列均值是否为0不予考虑，而在参数估计阶段，
            将序列均值作为一个参数加以估计。
2. 计算样本自(偏)自相关系数。
3. 模型识别|模型定阶: $ARMA(p, q)$模型。
    - 根据自相关图`SACF`，偏自相关图`SPACF`表现出的性质，选择适当的`ARMA`模型拟合观测值序列。

    |自相关系数$\rho_k$|偏自相关系数$\hat{\varphi}_{kk}$|选择模型|
    |-----------------|------------------------------|-------|
    |拖尾              |$p$ 阶截尾                     |$AR(p)$|
    |$q$ 阶截尾        |拖尾                           |$MA(q)$|
    |拖尾              |拖尾                           |$ARMA(p, q)$|
    
    

4. 参数估计
5. 模型检验
6. 模型的优化
7. 模型预测


---

## 非平稳时间序列的随机分析

---

## 非平稳时间序列的确定性分析

---

## 多元时间序列分析


---
🛠 **Python 时间序列代码待补充**

📚 **Reference**

- [1] [时间序列分析](https://www.icourse163.org/course/ZNUEDU-1207055804)

